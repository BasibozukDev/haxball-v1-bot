let golluStad2V3 = `{"name":"Futsal x3 ùóïùóøùó∂ùóÆùóª [ ú·¥Äx·¥ç·¥è·¥Ös.·¥Ñ·¥è·¥ç]","width":648,"height":270,"bg":{"type":"grass","width":550,
"height":240,"kickOffRadius":80,"color":"5A6C52","cornerRadius":0},"vertexes":[{"x":550,"y":240,"cMask":["ball"]},
{"x":550,"y":-240,"cMask":["ball"]},{"x":0,"y":270,"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},
{"x":0,"y":80,"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},{"x":0,"y":-80,"bCoef":0.1,
"cMask":["red","blue"],"cGroup":["redKO","blueKO"],"_selected":"segment","_data":{"mirror":{}}},{"x":0,"y":-270,
"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"],"_selected":"segment","_data":{"mirror":{}}},
{"x":-550,"y":-80,"bCoef":0.1,"cMask":["ball"]},{"x":-585,"y":-80,"bCoef":0.1,"cMask":["ball"]},{"x":-585,"y":80,
"bCoef":0.1,"cMask":["ball"]},{"x":-550,"y":80,"bCoef":0.1,"cMask":["ball"]},{"x":550,"y":-80,"bCoef":0.1,
"cMask":["ball"]},{"x":585,"y":-80,"bCoef":0.1,"cMask":["ball"]},{"x":585,"y":80,"bCoef":0.1,"cMask":["ball"]},
{"x":550,"y":80,"bCoef":0.1,"cMask":["ball"]},{"x":-550,"y":80,"bCoef":1.25,"cMask":["ball"]},{"x":-550,"y":240,
"bCoef":1.25,"cMask":["ball"]},{"x":-550,"y":-80,"bCoef":1.25,"cMask":["ball"]},{"x":-550,"y":-240,"bCoef":1.25,
"cMask":["ball"]},{"x":-550,"y":240,"cMask":["ball"]},{"x":550,"y":240,"cMask":["ball"]},{"x":550,"y":80,
"bCoef":1.25,"cMask":["ball"]},{"x":550,"y":240,"bCoef":1.25,"cMask":["ball"]},{"x":550,"y":-240,"bCoef":1.25,
"cMask":["ball"]},{"x":550,"y":-80,"bCoef":1.25,"cMask":["ball"]},{"x":550,"y":-240,"bCoef":0,"cMask":["ball"]},
{"x":550,"y":-240,"bCoef":0,"cMask":["ball"]},{"x":-550,"y":-240,"cMask":["ball"]},{"x":550,"y":-240,"cMask":["ball"]},
{"x":0,"y":-240,"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},{"x":0,"y":-80,"bCoef":0.1,
"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},{"x":0,"y":80,"bCoef":0.1,"cMask":["red","blue"],
"cGroup":["redKO","blueKO"]},{"x":0,"y":240,"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},
{"x":0,"y":-80,"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},{"x":0,"y":80,"bCoef":0.1,
"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},{"x":0,"y":80,"bCoef":0.1,"cMask":["red","blue"],
"cGroup":["redKO","blueKO"]},{"x":0,"y":-80,"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},
{"x":0,"y":80,"bCoef":0.1,"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},{"x":0,"y":-80,"bCoef":0.1,
"cMask":["red","blue"],"cGroup":["redKO","blueKO"]},{"x":-557.5,"y":80,"bCoef":0.1,"cMask":["ball"]},
{"x":-557.5,"y":240,"bCoef":2,"cMask":["ball"]},{"x":-557.5,"y":-240,"bCoef":2,"cMask":["ball"]},{"x":-557.5,
"y":-80,"bCoef":0.1,"cMask":["ball"]},{"x":557.5,"y":-240,"bCoef":2,"cMask":["ball"]},{"x":557.5,"y":-80,
"bCoef":0.1,"cMask":["ball"]},{"x":557.5,"y":80,"bCoef":0.1,"cMask":["ball"]},{"x":557.5,"y":240,"bCoef":2,
"cMask":["ball"]},{"x":0,"y":-80,"bCoef":0.1,"cMask":[]},{"x":0,"y":80,"bCoef":0.1,"cMask":[]},{"x":-550,
"y":-80,"bCoef":0.1,"cMask":[]},{"x":-550,"y":80,"bCoef":0.1,"cMask":[]},{"x":550,"y":-80,"bCoef":0.1,
"cMask":[]},{"x":550,"y":80,"bCoef":0.1,"cMask":[]},{"x":-550,"y":225,"bCoef":0.1,"cMask":[]},{"x":-535,"y":240,
"bCoef":0.1,"cMask":[]},{"x":-550,"y":-225,"bCoef":0.1,"cMask":[]},{"x":-535,"y":-240,"bCoef":0.1,"cMask":[]},
{"x":550,"y":-225,"bCoef":0.1,"cMask":[]},{"x":535,"y":-240,"bCoef":0.1,"cMask":[]},{"x":550,"y":225,"bCoef":0.1,
"cMask":[]},{"x":535,"y":240,"bCoef":0.1,"cMask":[]},{"x":-557.5,"y":-78.5,"bCoef":0.1,"cMask":[]},{"x":-557.5,
"y":78.5,"bCoef":0.1,"cMask":[]},{"x":-550,"y":-95,"bCoef":0.1,"cMask":[]},{"x":-490,"y":-95,"bCoef":0.1,
"cMask":[]},{"x":-490,"y":95,"bCoef":0.1,"cMask":[]},{"x":-550,"y":95,"bCoef":0.1,"cMask":[]},{"x":-550,
"y":-160,"bCoef":0.1,"cMask":[]},{"x":-390,"y":-160,"bCoef":0.1,"cMask":[]},{"x":-390,"y":160,"bCoef":0.1,
"cMask":[]},{"x":-550,"y":160,"bCoef":0.1,"cMask":[]},{"x":-390,"y":-70,"bCoef":0.1,"cMask":[]},{"x":-390,
"y":70,"bCoef":0.1,"cMask":[]},{"x":-440,"y":-1.5,"bCoef":0.1,"cMask":[]},{"x":-440,"y":1.5,"bCoef":0.1,
"cMask":[]},{"x":-440,"y":-1.5,"bCoef":0.1,"cMask":[]},{"x":-440,"y":1.5,"bCoef":0.1,"cMask":[]},{"x":550,
"y":95,"bCoef":0.1,"cMask":[]},{"x":490,"y":95,"bCoef":0.1,"cMask":[]},{"x":490,"y":-95,"bCoef":0.1,"cMask":[]},
{"x":550,"y":-95,"bCoef":0.1,"cMask":[]},{"x":550,"y":160,"bCoef":0.1,"cMask":[]},{"x":390,"y":160,
"bCoef":0.1,"cMask":[]},{"x":390,"y":-160,"bCoef":0.1,"cMask":[]},{"x":550,"y":-160,"bCoef":0.1,"cMask":[]},
{"x":440,"y":-1.5,"bCoef":0.1,"cMask":[]},{"x":440,"y":1.5,"bCoef":0.1,"cMask":[]},{"x":440,"y":-1.5,
"bCoef":0.1,"cMask":[]},{"x":440,"y":1.5,"bCoef":0.1,"cMask":[]},{"x":390,"y":-70,"bCoef":0.1,"cMask":[]},
{"x":390,"y":70,"bCoef":0.1,"cMask":[]},{"x":-567.5,"y":-78.5,"bCoef":0.1,"cMask":[]},{"x":-567.5,"y":78.5,
"bCoef":0.1,"cMask":[]},{"x":-577.5,"y":-78.5,"bCoef":0.1,"cMask":[]},{"x":-577.5,"y":78.5,"bCoef":0.1,
"cMask":[]},{"x":577.5,"y":-78.5,"bCoef":0.1,"cMask":[]},{"x":577.5,"y":78.5,"bCoef":0.1,"cMask":[]},
{"x":567.5,"y":-78.5,"bCoef":0.1,"cMask":[]},{"x":567.5,"y":78.5,"bCoef":0.1,"cMask":[]},{"x":557.5,
"y":-78.5,"bCoef":0.1,"cMask":[]},{"x":557.5,"y":78.5,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":5,"bCoef":0.1,
"cMask":[]},{"x":-551.5,"y":5,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":-5,"bCoef":0.1,"cMask":[]},{"x":-551.5,
"y":-5,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":-15,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":-15,"bCoef":0.1,
"cMask":[]},{"x":-583.5,"y":-25,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":-25,"bCoef":0.1,"cMask":[]},{"x":-583.5,
"y":-35,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":-35,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":-45,"bCoef":0.1,
"cMask":[]},{"x":-551.5,"y":-45,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":-55,"bCoef":0.1,"cMask":[]},{"x":-551.5,
"y":-55,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":-65,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":-65,"bCoef":0.1,"cMask":[]},
{"x":-583.5,"y":-75,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":-75,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":15,"bCoef":0.1,
"cMask":[]},{"x":-551.5,"y":15,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":25,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":25,
"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":35,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":35,"bCoef":0.1,"cMask":[]},
{"x":-583.5,"y":45,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":45,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":55,"bCoef":0.1,
"cMask":[]},{"x":-551.5,"y":55,"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":65,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":65,
"bCoef":0.1,"cMask":[]},{"x":-583.5,"y":75,"bCoef":0.1,"cMask":[]},{"x":-551.5,"y":75,"bCoef":0.1,"cMask":[]},
{"x":583.5,"y":5,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":5,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":15,"bCoef":0.1,
"cMask":[]},{"x":551.5,"y":15,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":25,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":25,
"bCoef":0.1,"cMask":[]},{"x":583.5,"y":35,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":35,"bCoef":0.1,"cMask":[]},
{"x":583.5,"y":45,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":45,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":55,"bCoef":0.1,
"cMask":[]},{"x":551.5,"y":55,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":65,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":65,
"bCoef":0.1,"cMask":[]},{"x":583.5,"y":75,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":75,"bCoef":0.1,"cMask":[]},
{"x":583.5,"y":-75,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":-75,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":-65,"bCoef":0.1,
"cMask":[]},{"x":551.5,"y":-65,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":-55,"bCoef":0.1,"cMask":[]},{"x":551.5,
"y":-55,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":-45,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":-45,"bCoef":0.1,"cMask":[]},
{"x":583.5,"y":-35,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":-35,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":-25,
"bCoef":0.1,"cMask":[]},{"x":551.5,"y":-25,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":-15,"bCoef":0.1,"cMask":[]},
{"x":551.5,"y":-15,"bCoef":0.1,"cMask":[]},{"x":583.5,"y":-5,"bCoef":0.1,"cMask":[]},{"x":551.5,"y":-5,"bCoef":0.1,
"cMask":[]},{"x":0,"y":-1.5,"bCoef":0.1,"cMask":[]},{"x":0,"y":1.5,"bCoef":0.1,"cMask":[]},{"x":0,"y":-1.5,
"bCoef":0.1,"cMask":[]},{"x":0,"y":1.5,"bCoef":0.1,"cMask":[]}],"segments":[{"v0":6,"v1":7,"color":"FFFFFF",
"bCoef":0.1,"cMask":["ball"]},{"v0":7,"v1":8,"color":"FFFFFF","bCoef":0.1,"cMask":["ball"]},{"v0":8,"v1":9,
"color":"FFFFFF","bCoef":0.1,"cMask":["ball"]},{"v0":10,"v1":11,"color":"FFFFFF","bCoef":0.1,"cMask":["ball"]},
{"v0":11,"v1":12,"color":"FFFFFF","bCoef":0.1,"cMask":["ball"]},{"v0":12,"v1":13,"color":"FFFFFF","bCoef":0.1,
"cMask":["ball"]},{"v0":2,"v1":3,"vis":false,"bCoef":0.1,"cMask":[],"cGroup":[]},{"v0":3,"v1":4,"curve":180,
"color":"C5F0C9","bCoef":0.1,"cMask":[],"cGroup":[],"curveF":6.123233995736766e-17},{"v0":4,"v1":3,"curve":180,
"color":"C5F0C9","bCoef":0.1,"cMask":[],"cGroup":[],"curveF":6.123233995736766e-17},{"v0":4,"v1":5,"vis":false,
"bCoef":0.1,"cMask":[],"cGroup":[],"_selected":true,"_data":{"mirror":{},"arc":{"a":[0,-80],"b":[0,-270],
"radius":null,"center":[null,null],"from":null,"to":null}}},{"v0":14,"v1":15,"color":"C5F0C9","bCoef":1.25,
"cMask":["ball"]},{"v0":16,"v1":17,"color":"C5F0C9","bCoef":1.25,"cMask":["ball"]},{"v0":18,"v1":19,
"color":"C5F0C9","cMask":["ball"]},{"v0":20,"v1":21,"color":"C5F0C9","bCoef":1.25,"cMask":["ball"]},
{"v0":22,"v1":23,"color":"C5F0C9","bCoef":1.25,"cMask":["ball"]},{"v0":24,"v1":25,"color":"F8F8F8",
"bCoef":0,"cMask":["ball"]},{"v0":26,"v1":27,"color":"C5F0C9","cMask":["ball"]},{"v0":28,"v1":29,
"color":"C5F0C9","bCoef":0.1,"cMask":[],"cGroup":[]},{"v0":30,"v1":31,"color":"C5F0C9","bCoef":0.1,"cMask":[],
"cGroup":[]},{"v0":38,"v1":39,"vis":false,"color":"F8F8F8","bCoef":2,"cMask":["ball"]},{"v0":40,"v1":41,
"vis":false,"color":"F8F8F8","bCoef":2,"cMask":["ball"]},{"v0":42,"v1":43,"vis":false,"color":"F8F8F8","bCoef":2,
"cMask":["ball"]},{"v0":44,"v1":45,"vis":false,"color":"F8F8F8","bCoef":2,"cMask":["ball"]},{"v0":46,"v1":47,
"color":"C5F0C9","bCoef":0.1,"cMask":[]},{"v0":48,"v1":49,"color":"F8F8F8","bCoef":0.1,"cMask":[]},{"v0":50,
"v1":51,"color":"F8F8F8","bCoef":0.1,"cMask":[]},{"v0":52,"v1":53,"curve":89.99999999999999,"color":"C5F0C9",
"bCoef":0.1,"cMask":[],"curveF":1.0000000000000002},{"v0":55,"v1":54,"curve":89.99999999999999,"color":"C5F0C9",
"bCoef":0.1,"cMask":[],"curveF":1.0000000000000002},{"v0":56,"v1":57,"curve":89.99999999999999,"color":"C5F0C9",
"bCoef":0.1,"cMask":[],"curveF":1.0000000000000002},{"v0":59,"v1":58,"curve":89.99999999999999,"color":"C5F0C9",
"bCoef":0.1,"cMask":[],"curveF":1.0000000000000002},{"v0":60,"v1":61,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":62,"v1":63,"color":"C5F0C9","bCoef":0.1,"cMask":[]},{"v0":64,"v1":63,"color":"C5F0C9","bCoef":0.1,"cMask":[]},
{"v0":65,"v1":64,"color":"C5F0C9","bCoef":0.1,"cMask":[]},{"v0":66,"v1":67,"color":"C5F0C9","bCoef":0.1,"cMask":[]},
{"v0":68,"v1":67,"color":"C5F0C9","bCoef":0.1,"cMask":[]},{"v0":69,"v1":68,"color":"C5F0C9","bCoef":0.1,"cMask":[]},
{"v0":70,"v1":71,"curve":110,"color":"C5F0C9","bCoef":0.1,"cMask":[],"curveF":0.7002075382097098},{"v0":72,"v1":73,
"curve":180,"color":"C5F0C9","bCoef":0.1,"cMask":[],"curveF":6.123233995736766e-17},{"v0":75,"v1":74,"curve":180,
"color":"C5F0C9","bCoef":0.1,"cMask":[],"curveF":6.123233995736766e-17},{"v0":76,"v1":77,"color":"C5F0C9",
"bCoef":0.1,"cMask":[]},{"v0":78,"v1":77,"color":"C5F0C9","bCoef":0.1,"cMask":[]},{"v0":79,"v1":78,
"color":"C5F0C9","bCoef":0.1,"cMask":[]},{"v0":80,"v1":81,"color":"C5F0C9","bCoef":0.1,"cMask":[]},
{"v0":82,"v1":81,"color":"C5F0C9","bCoef":0.1,"cMask":[]},{"v0":83,"v1":82,"color":"C5F0C9","bCoef":0.1,"cMask":[]},
{"v0":84,"v1":85,"curve":180,"color":"C5F0C9","bCoef":0.1,"cMask":[],"curveF":6.123233995736766e-17},
{"v0":87,"v1":86,"curve":180,"color":"C5F0C9","bCoef":0.1,"cMask":[],"curveF":6.123233995736766e-17},
{"v0":89,"v1":88,"curve":110,"color":"C5F0C9","bCoef":0.1,"cMask":[],"curveF":0.7002075382097098},
{"v0":90,"v1":91,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":92,"v1":93,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":94,"v1":95,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":96,"v1":97,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":98,"v1":99,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":100,"v1":101,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":102,"v1":103,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":104,"v1":105,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":106,"v1":107,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":108,"v1":109,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":110,"v1":111,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":112,"v1":113,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":114,"v1":115,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":116,"v1":117,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":118,"v1":119,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":120,"v1":121,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":122,"v1":123,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":124,"v1":125,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":126,"v1":127,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":128,"v1":129,"color":"E89C8D","bCoef":0.1,"cMask":[]},
{"v0":130,"v1":131,"color":"E89C8D","bCoef":0.1,"cMask":[]},{"v0":132,"v1":133,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":134,"v1":135,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":136,"v1":137,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":138,"v1":139,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":140,"v1":141,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":142,"v1":143,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":144,"v1":145,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":146,"v1":147,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":148,"v1":149,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":150,"v1":151,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":152,"v1":153,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":154,"v1":155,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":156,"v1":157,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":158,"v1":159,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":160,"v1":161,"color":"9DBBE9","bCoef":0.1,"cMask":[]},
{"v0":162,"v1":163,"color":"9DBBE9","bCoef":0.1,"cMask":[]},{"v0":164,"v1":165,"curve":180,"color":"C5F0C9","bCoef":0.1,
"cMask":[],"curveF":6.123233995736766e-17},{"v0":167,"v1":166,"curve":180,"color":"C5F0C9","bCoef":0.1,"cMask":[],
"curveF":6.123233995736766e-17}],"planes":[{"normal":[0,1],"dist":-240,"cMask":["ball"],
"_data":{"extremes":{"normal":[0,1],"dist":-240,"canvas_rect":[-648,-270,648,270],"a":[-648,-240],
"b":[648,-240]}}},{"normal":[0,-1],"dist":-240,"cMask":["ball"],"_data":{"extremes":{"normal":[0,-1],
"dist":-240,"canvas_rect":[-648,-270,648,270],"a":[-648,240],"b":[648,240]}}},{"normal":[0,1],"dist":-270,
"bCoef":0.1,"_data":{"extremes":{"normal":[0,1],"dist":-270,"canvas_rect":[-648,-270,648,270],"a":[-648,-270],
"b":[648,-270]}}},{"normal":[0,-1],"dist":-270,"bCoef":0.1,"_data":{"extremes":{"normal":[0,-1],"dist":-270,
"canvas_rect":[-648,-270,648,270],"a":[-648,270],"b":[648,270]}}},{"normal":[1,0],"dist":-642,"bCoef":0.1,
"_data":{"extremes":{"normal":[1,0],"dist":-642,"canvas_rect":[-648,-270,648,270],"a":[-642,-270],"b":[-642,270]}}},
{"normal":[-1,0],"dist":-644,"bCoef":0.1,"_data":{"extremes":{"normal":[-1,0],"dist":-644,
"canvas_rect":[-648,-270,648,270],"a":[644,-270],"b":[644,270]}}},{"normal":[1,0],"dist":-642,"bCoef":0.1,
"cMask":["ball"],"_data":{"extremes":{"normal":[1,0],"dist":-642,"canvas_rect":[-648,-270,648,270],"a":[-642,-270],
"b":[-642,270]}}},{"normal":[-1,0],"dist":-643,"bCoef":0.1,"cMask":["ball"],"_data":{"extremes":{"normal":[-1,0],
"dist":-643,"canvas_rect":[-648,-270,648,270],"a":[643,-270],"b":[643,270]}}}],"goals":[{"p0":[-556.3,-80],
"p1":[-556.3,80],"team":"red"},{"p0":[556.3,80],"p1":[556.3,-80],"team":"blue"}],"discs":[{"radius":6.3,
"invMass":1.5,"pos":[0,0],"bCoef":0.4,"cGroup":["ball","kick","score"]},{"radius":4.5,"invMass":0,"pos":[-550,80]},
{"radius":4.5,"invMass":0,"pos":[-550,-80]},{"radius":4.5,"invMass":0,"pos":[550,80]},{"radius":4.5,"invMass":0,
"pos":[550,-80]},{"radius":3,"invMass":0,"pos":[-550,240],"bCoef":0.1,"cMask":[]},{"radius":3,"invMass":0,
"pos":[-550,-240],"bCoef":0.1,"cMask":[]},{"radius":3,"invMass":0,"pos":[550,-240],"bCoef":0.1,"cMask":[]},
{"radius":3,"invMass":0,"pos":[550,240],"bCoef":0.1,"cMask":[]},{"radius":3,"invMass":0,"pos":[-585,80]},
{"radius":3,"invMass":0,"pos":[-585,-80]},{"radius":3,"invMass":0,"pos":[585,-80]},{"radius":3,"invMass":0,
"pos":[585,80]}],"playerPhysics":{"bCoef":0,"acceleration":0.11,"kickingAcceleration":0.083,"kickStrength":4.5},
"ballPhysics":"disc0","spawnDistance":350,"canBeStored":false,"traits":{},"joints":[],"redSpawnPoints":[],
"blueSpawnPoints":[]}`;

let leagueName = "S√ºper Lig";

const room = HBInit({
  roomName: "üèÜ " + "S√úPER Lƒ∞G SOFT" + " üèÜ #BAZOU",
  maxPlayers: 8,
  public: true,
  noPlayer: true,
  geo: {
    code: "TR"
  }
});

let gameTime = 60;

room.setScoreLimit(0);
room.setTimeLimit(0);
room.setTeamsLock(true);

let takimlar = [
    {
      adi: "üü£‚ö´Ô∏è Adana Demirspor",
      kisaAdi: "ADS",
      renkler: {
        angle: 0,
        textColor: 16777215,
        colors: [2235759, 9359088, 2235759]
      },
      id: 1
    },
    {
      adi: "üü†‚ö™Ô∏è Alanyaspor",
      kisaAdi: "ALA",
      renkler: { angle: 0, textColor: 16777215, colors: [15885568] },
      id: 2
    },
    {
      adi: "‚ö™Ô∏è‚ö´Ô∏è Altay",
      kisaAdi: "ALT",
      renkler: { angle: 0, textColor: 7833753, colors: [16777215, 0, 16777215] },
      id: 3
    },
    {
      adi: "üî¥‚ö™Ô∏è Antalyaspor",
      kisaAdi: "ANT",
      renkler: { angle: 0, textColor: 0, colors: [16777215, 16711680, 16777215] },
      id: 4
    },
    {
      adi: "üü†üîµ Ba≈üak≈üehir",
      kisaAdi: "BA≈û",
      renkler: { angle: 0, textColor: 16777215, colors: [1981016, 15556135] },
      id: 5
    },
    {
      adi: "‚ö´Ô∏è‚ö™Ô∏è Be≈üikta≈ü",
      kisaAdi: "BJK",
      renkler: { angle: 0, textColor: 0, colors: [16579836, 12845056, 16579836] },
      id: 6
    },
    {
      adi: "üü°üîµ Fenerbah√ße",
      kisaAdi: "FB",
      renkler: {
        angle: 0,
        textColor: 16777215,
        colors: [16768781, 10590, 16768781]
      },
      id: 7
    },
    {
      adi: "üî¥‚ö´Ô∏è Fatih Karag√ºmr√ºk",
      kisaAdi: "FKSK",
      renkler: { angle: 0, textColor: 16777215, colors: [16711680, 0, 16711680] },
      id: 8
    },
    {
      adi: "‚ö´Ô∏èüî¥ Gaziantep FK",
      kisaAdi: "GFK",
      renkler: { angle: 0, textColor: 16777215, colors: [0, 16711680, 0] },
      id: 9
    },
    {
      adi: "‚ö™Ô∏èüü¢ Giresunspor",
      kisaAdi: "GRS",
      renkler: { angle: 0, textColor: 0, colors: [2979118, 16777215, 2979118] },
      id: 10
    },
    {
      adi: "üü°üî¥ Galatasaray",
      kisaAdi: "GS",
      renkler: { angle: 0, textColor: 16579836, colors: [16750848, 8716288] },
      id: 11
    },
    {
      adi: "üî¥üü° G√∂ztepe",
      kisaAdi: "G√ñZ",
      renkler: { angle: 0, textColor: 16777215, colors: [16776960, 16711680] },
      id: 12
    },
    {
      adi: "‚ö™Ô∏èüü§ Hatayspor",
      kisaAdi: "HAT",
      renkler: { angle: 0, textColor: 16777215, colors: [8990269] },
      id: 13
    },
    {
      adi: "üîµ‚ö™Ô∏è Kasƒ±mpa≈üa",
      kisaAdi: "KAS",
      renkler: { angle: 0, textColor: 0, colors: [5120186, 16777215, 5120186] },
      id: 14
    },
    {
      adi: "üü¢‚ö™Ô∏è Konyaspor",
      kisaAdi: "KON",
      renkler: { angle: 0, textColor: 16777215, colors: [3053924] },
      id: 15
    },
    {
      adi: "üî¥üü° Kayserispor",
      kisaAdi: "KS",
      renkler: { angle: 0, textColor: 0, colors: [16711680, 16776960, 16711680] },
      id: 16
    },
    {
      adi: "üü¢üîµ Rizespor",
      kisaAdi: "Rƒ∞Z",
      renkler: {
        angle: 0,
        textColor: 16777215,
        colors: [5120186, 2979118, 5120186]
      },
      id: 17
    },
    {
      adi: "‚ö™Ô∏èüî¥ Sivasspor",
      kisaAdi: "SVS",
      renkler: { angle: 0, textColor: 0, colors: [16711680, 16777215, 16711680] },
      id: 18
    },
    {
      adi: "üü§üü£ Trabzonspor",
      kisaAdi: "TS",
      renkler: {
        angle: 0,
        textColor: 16777215,
        colors: [10755380, 1360113, 10755380]
      },
      id: 19
    },
    {
      adi: "üî¥üü° Yeni Malatya",
      kisaAdi: "YMLT",
      renkler: { angle: 0, textColor: 0, colors: [16776960, 16711680, 16776960] },
      id: 20
    }
  ];

let puanDurumuOlustur = function() {
  return [
    { toId: 1, o: 0, g: 0, b: 0, m: 0, ag: 0, yg: 0, a: 0, p: 0 },
    { toId: 2, o: 0, g: 0, b: 0, m: 0, ag: 0, yg: 0, a: 0, p: 0 },
    { toId: 3, o: 0, g: 0, b: 0, m: 0, ag: 0, yg: 0, a: 0, p: 0 },
    { toId: 4, o: 0, g: 0, b: 0, m: 0, ag: 0, yg: 0, a: 0, p: 0 },
    { toId: 5, o: 0, g: 0, b: 0, m: 0, ag: 0, yg: 0, a: 0, p: 0 },
    { toId: 6, o: 0, g: 0, b: 0, m: 0, ag: 0, yg: 0, a: 0, p: 0 }
  ];
};

let takimliOyuncularOlustur = function() {
  return [
    { id: 1, playerId: null, takimId: null, oncekiPlayerId: null },
    { id: 2, playerId: null, takimId: null, oncekiPlayerId: null },
    { id: 3, playerId: null, takimId: null, oncekiPlayerId: null },
    { id: 4, playerId: null, takimId: null, oncekiPlayerId: null },
    { id: 5, playerId: null, takimId: null, oncekiPlayerId: null },
    { id: 6, playerId: null, takimId: null, oncekiPlayerId: null }
  ];
};

let takimGirisKontrolOlustur = function() {
  return [
    { toId: 1, kabulEdenler: [], kabulEtmeyenler: [], idler: [] },
    { toId: 2, kabulEdenler: [], kabulEtmeyenler: [], idler: [] },
    { toId: 3, kabulEdenler: [], kabulEtmeyenler: [], idler: [] },
    { toId: 4, kabulEdenler: [], kabulEtmeyenler: [], idler: [] },
    { toId: 5, kabulEdenler: [], kabulEtmeyenler: [], idler: [] },
    { toId: 6, kabulEdenler: [], kabulEtmeyenler: [], idler: [] }
  ];
};

let dahilOlmaIslemiOlustur = function() {
  return {
    dahilOlAktifMi: false,
    dahilOlunanTOId: null
  };
};

let dahilOlTimeoutsOlustur = function() {
  return {
    takimGirisKontrol: null,
    dahilOlPromise: null
  };
};

let chatMessageSayisi = 0;

let chatPromise = async function() {
  chatMessageSayisi = 0;
  new Promise(() => {
    setTimeout(chatPromise, 10000);
  });
};

chatPromise();

let gameState = 0;

let turnuvaZamaniOyunculari = [];

let players = [];

let takimliOyuncular = takimliOyuncularOlustur();

let yedekOyuncular = [];

let fikstur = [];

let fiksturSirasi = -1;

let geciciOyunculariYerlestir = function () {
  for (let index = 0; index < players.length; index++) {
    if(index % 2 === 0){
      room.setPlayerTeam(players[index].id, 1);
    }
    else {
      room.setPlayerTeam(players[index].id, 2);
    }
  }
}
let geciciOyun = function () {
  room.setCustomStadium(golluStad2V3);
  room.startGame();
}

geciciOyun();

let takimPuanDurumu = puanDurumuOlustur();

let skor = { red: 0, blue: 0 };

let puanDurumuString = "";

let chatStyle = {
  normal: "normal",
  bold: "bold",
  italic: "italic",
  small: "small",
  smallBold: "small-bold",
  smallItalic: "small-italic"
};

let chatSound = {
  noSound: 0,
  normal: 1,
  notification: 2
};

let chatColor = {
  red: 0xff0000,
  green: 0x00ff00,
  blue: 0x0000ff,
  white: 0xffffff,
  yellow: 0xffff00,
  bilgi: 0x3399ff,
  basari: 0xff8000,
  admin: 0x61ed99
};

let takimGirisleriKontrol = takimGirisKontrolOlustur();

let dahilOlmaIslemi = dahilOlmaIslemiOlustur();

let dahilOlTimeouts = dahilOlTimeoutsOlustur();

let topaDokunmaKontrolu = { red: 0, blue: 0 };

let kendiKalesineGolAtmaKontrolu = { red: 0, blue: 0 };

let oyunuBaslatmaKontrolu = { timeout: null };

let hostMesajlari = {
  hosgeldin: function(name) {
    let chat = {
      message: "Bazou Ger√ßek Ligler'e ho≈ügeldin! Komutlar i√ßin: !komutlar yaz. 6 ki≈üi takƒ±m se√ßtiƒüinde lig ba≈ülar! ƒ∞yi eƒülenceler @" + name + "!",
      color: chatColor.bilgi,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  komutlar: function() {
    let chat = {
      message: "!ts, !pd, !f, !hf, !ut, !t≈ü, !i, !≈ü, !hi, !h≈ü, !≈üt, !≈üo  | T√ºm komutlarƒ±n ayrƒ±ntƒ±lƒ± a√ßƒ±klamasƒ± i√ßin !dc yaz. Sunucuya atla!", 
      color: chatColor.bilgi,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  mesajGonderilemedi: function(message) {
    let chat = {
      message: message,
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  yavaslatilmisMod: function() {
    let chat = {
      message: "Chat yava≈ülatƒ±ldƒ±.",
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.noSound
    };
    return chat;
  },
  uygunTakimlar: function() {
    let takimIdleri = uygunTakimlariDondur();
    let msg = "";
    for (let index = 0; index < takimIdleri.length; index++) {
      let takim = takimiDondur(takimIdleri[index]);
      let txt = takim.kisaAdi + ": " + takim.id + " ";
      msg += txt;
    }
    let chat = {
      message: msg,
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  yeniTakim: function(takimAdi) {
    let chat = {
      message: `${takimAdi} takƒ±mƒ±nƒ±n ba≈üƒ±na ge√ßtin. Ba≈üarƒ±lar!`,
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  ligBasliyor: function() {
    let chat = {
      message: leagueName + " Ba≈ülƒ±yor üôå",
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  takimSec: function() {
    let chat = {
      message: "Hen√ºz takƒ±m se√ßmediƒüin i√ßin chat'i kullanamazsƒ±n.",
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  simdiTakimSec: function() {
    let chat = {
      message: "!ts komutuyla 10 saniye i√ßinde takƒ±m se√ßebilirsin.",
      color: chatColor.yellow,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  gol: function(takimTamAd) {
    let chat = {
      message: `GOOOOOOOOOL!! ${takimTamAd} gol√º attƒ±! Skor ${skor.red}-${skor.blue}!`,
      color: chatColor.yellow,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  puanDurumu: function() {
    let chat = {
      message: "Hen√ºz g√∂sterilecek bir puan durumu yok!",
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    if (puanDurumuString !== "") {
      chat.message = puanDurumuString;
      chat.color = chatColor.bilgi;
    }
    return chat;
  },
  fikstur: function(message) {
    let chat = {
      message: message,
      color: chatColor.bilgi,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  takimSecemezsin: function() {
    let chat = {
      message: `≈ûu an takƒ±m se√ßemezsin.`,
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  suanUygunDegil: function() {
    let chat = {
      message: `≈ûu an uygun deƒüil.`,
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  discord: function() {
    let chat = {
      message: `Discord sunucumuz: https://discord.gg/e5agUUCCxY`,
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  oyuncuMesaji: function(player, message, takimAdi) {
    let chat = {
      message: `${takimAdi} (${player.name}): ${message}`,
      color: chatColor.white,
      style: chatStyle.normal,
      sound: chatSound.normal
    };
    return chat;
  },
  baskasiSectiBildirimi: function(takim) {
    let chat = {
      message: takim + " takƒ±mƒ±nƒ± ba≈ükasƒ± se√ßmi≈ü!",
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  takimSectinBildirimi: function(takim) {
    let chat = {
      message: takim + " takƒ±mƒ±nƒ±n ba≈üƒ±na ge√ßtin. Ba≈üarƒ±lar!",
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  takimSecimiBildirimi: function(name, takim) {
    let chat = {
      message:
        name +
        ", " +
        takim +
        " takƒ±mƒ±nƒ±n ba≈üƒ±na ge√ßti! Kendisine ba≈üarƒ±lar diliyoruz!",
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  tdKomutuKullanimi: function() {
    let chat = {
      message: "!td 1-20 ≈üeklinde kullanmalƒ±sƒ±nƒ±z!",
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  dahilOlabilirsin: function(takimAdi, hafta, sira) {
    let message = `${takimAdi} y√∂netimini seni takƒ±mƒ±n ba≈üƒ±na ge√ßirmeyi d√º≈ü√ºn√ºyor. 
${takimAdi}, ${hafta} hafta sonunda ${sira}. sƒ±rada bulunuyor. Sen de ilgileniyorsan !evet yaz.`;
    let chat = {
      message: message,
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  onayiniAldik: function(takimAdi) {
    let message = `Teklifi onayladƒ±n. ${takimAdi} y√∂netimi birazdan nihai kararƒ±nƒ± verecek.`;
    let chat = {
      message: message,
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  atilacaksin: function() {
    let message = `Bir kez daha kendi kalene atarsan banlanacaksƒ±n.`;
    let chat = {
      message: message,
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  oyuncuAtilacak: function(name) {
    let message = `${name}, bir kez daha kendi kalesine atarsa banlanacak!`;
    let chat = {
      message: message,
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  oyuncuAtildi: function(name) {
    let message = `${name}, kendi kalesine attƒ±ƒüƒ± i√ßin banlandƒ±.`;
    let chat = {
      message: message,
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  oyunaBasla: function() {
    let message = `10 saniye i√ßinde oyuna ba≈üla.`;
    let chat = {
      message: message,
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  hukmenMaglup: function(name, takim) {
    let kacKac =
      skor.red > skor.blue
        ? `${skor.red}-${skor.blue}`
        : `${skor.blue}-${skor.red}`;
    let chat = {
      message: `${name} oyundan √ßƒ±ktƒ±ƒüƒ± i√ßin ${takim} h√ºkmen ${kacKac} maƒülup oldu.`,
      color: chatColor.green,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  },
  boyleBirKomutYok: function() {
    let chat = {
      message:
        "B√∂yle bir komut yok! Bir≈üeyleri eksik veya fazla yazmƒ±≈ü olabilirsin",
      color: chatColor.red,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  hukmenKazaniyor: function(hafta, kazanan, kaybeden) {
    let msg = `${hafta}. Hafta + ${kaybeden} oyunda olmadƒ±ƒüƒ± i√ßin ${kazanan} kar≈üƒ±la≈ümayƒ± 3-0 kazanƒ±yor!`;
    let chat = {
      message: msg,
      color: chatColor.yellow,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  berabereBitiyor: function(hafta, evSahibiTamAd, deplasmanTamAd) {
    let msg = `${hafta}. Hafta ${evSahibiTamAd} ve ${deplasmanTamAd} oyunda olmadƒ±ƒüƒ± i√ßin 0-0 ge√ßiliyor!`;
    let chat = {
      message: msg,
      color: chatColor.yellow,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  macBasladi: function(hafta, evSahibiTamAd, deplasmanTamAd) {
    let msg = `${hafta}. Hafta ${evSahibiTamAd} - ${deplasmanTamAd} kar≈üƒ±la≈ümasƒ± ba≈üladƒ±. ƒ∞yi seyirler!`;
    let chat = {
      message: msg,
      color: chatColor.yellow,
      style: chatStyle.bold,
      sound: chatSound.notification
    };
    return chat;
  },
  kutlama: function(kutlamaMesaji) {
    let chat = {
      message: kutlamaMesaji,
      color: chatColor.basari,
      style: chatStyle.bold,
      sound: chatSound.normal
    };
    return chat;
  }
};

let oyuncuAgiGecerliMi = function(conn) {
  let x = players.filter(oyuncu => oyuncu.conn === conn);
  return x.length === 0;
};

let oyuncuKimligiGecerliMi = function(auth) {
  let x = players.filter(oyuncu => oyuncu.auth === auth);
  return x.length === 0;
};

let karakterGecerliMi = function(char = "") {
    if (char.charCodeAt() <= 31) {
      return false;
    }
  
    let yasakKarakterNolar = [
      39,
      40,
      41,
      127,
      129,
      141,
      143,
      144,
      157,
      168,
      173,
      3020,
      65021
    ];
  
    for (const item of yasakKarakterNolar) {
      if (item === char.charCodeAt()) {
        return false;
      }
    }
  
    return true;
  };

let oyuncuNickiKarakterleriGecerliMi = function(name) {
  for (const char of name) {
    if (!karakterGecerliMi(char)) {
      return false;
    }
  }
  return true;
};

let oyuncuNickininOnundeSonundaBoslukVarMi = function(name) {
  if (name.startsWith(" ") || name.endsWith(" ")) {
    return false;
  }
  return true;
};

let oyuncuTurnuvaGirisSayisiniHesapla = function(auth) {
  let sayi = turnuvaZamaniOyunculari.filter(x => x.auth === auth).length;
  return sayi;
};

let takimiDondur = function(id) {
  for (const item of takimlar) {
    if (id === item.id) {
      return item;
    }
  }
  return false;
};

let uygunTakimlariDondur = function() {
  let takimIdleri = [];
  let secilmistakimIdleri = [];

  for (const takim of takimlar) {
    takimIdleri.push(takim.id);
  }

  for (const item of takimliOyuncular) {
    if (item.takimId !== null) {
      secilmistakimIdleri.push(item.takimId);
    }
  }

  return takimIdleri.filter(x => !secilmistakimIdleri.includes(x));
};

let uygunTakimliOyuncuDondur = function() {
  for (const item of takimliOyuncular) {
    if (item.playerId === null) {
      return item;
    }
  }
  return false;
};

let mesajKarakteriGecerliMi = function(char) {
  if (char.charCodeAt() >= 32 && char.charCodeAt() <= 90) {
    return true;
  } else if (char.charCodeAt() >= 65 && char.charCodeAt() <= 90) {
    return true;
  } else if (char.charCodeAt() >= 97 && char.charCodeAt() <= 122) {
    return true;
  } else if (char.charCodeAt() >= 192 && char.charCodeAt() <= 214) {
    return true;
  } else if (char.charCodeAt() >= 216 && char.charCodeAt() <= 246) {
    return true;
  } else if (char.charCodeAt() >= 248 && char.charCodeAt() <= 382) {
    return true;
  } else {
    return false;
  }
};

let oyuncuMesajiUTF8GecerliMi = function(message) {
  for (const char of message) {
    if (!mesajKarakteriGecerliMi(char)) {
      return false;
    }
  }
  return true;
};

let oyuncuMesajIcerigiGecerliMi = function(message = "") {
  let kufurler = [
    "o√ß",
    "anan",
    "bacƒ±n",
    "s√ºlaleni",
    "√ßocuƒüu",
    "orospu",
    "evladƒ±",
    "evladi",
    "amkoƒülu",
    "amƒ±noƒülu",
    "amƒ±n oƒülu",
    "amk oƒülu"
  ];
  for (const kufur of kufurler) {
    if (message.includes(kufur)) {
      return false;
    }
  }
  return true;
};

let mesajGecerliMi = function(message = "") {
  let messageKisaligiUygunMu = message.length > 0;
  let messageUzunluguUygunMu = message.length <= 60;
  let messageUTF8GecerliMi = oyuncuMesajiUTF8GecerliMi(message);
  let messageIcerigiGecerliMi = oyuncuMesajIcerigiGecerliMi(message);

  if (!messageKisaligiUygunMu) {
    return { return: false, message: null };
  }
  if (!messageUzunluguUygunMu) {
    return {
      return: false,
      message: "Mesajƒ±nƒ±z 60'tan fazla karakter i√ßerdiƒüi i√ßin g√∂nderilemedi."
    };
  }
  if (!messageUTF8GecerliMi) {
    return {
      return: false,
      message: "Mesajƒ±nƒ±z ge√ßersiz karakter i√ßerdiƒüi i√ßin g√∂nderilemedi."
    };
  }
  if (!messageIcerigiGecerliMi) {
    return {
      return: false,
      message: "Mesajƒ±nƒ±zda aƒüƒ±r hakaret algƒ±landƒ±ƒüƒ± i√ßin g√∂nderilemedi."
    };
  }

  return { return: true };
};

let oyuncuGecerliMi = function(player) {
  let agGecerliMi = oyuncuAgiGecerliMi(player.conn);
  let kimlikGecerliMi = oyuncuKimligiGecerliMi(player.auth);
  let nickKarakterleriGecerliMi = oyuncuNickiKarakterleriGecerliMi(player.name);
  let nickinOnundeSonundaBoslukVarMi = oyuncuNickininOnundeSonundaBoslukVarMi(
    player.name
  );
  let turnuvaGirisSayisi = oyuncuTurnuvaGirisSayisiniHesapla(player.auth);
  
  if (!agGecerliMi) {
    return { return: false, message: "Aynƒ± aƒüdan iki giri≈ü yasaktƒ±r." };
  }

  if (!kimlikGecerliMi) {
    return { return: false, message: "ƒ∞ki sekmeden giri≈ü yasaktƒ±r." };
  }
/*
  if (!nickKarakterleriGecerliMi) {
    return {
      return: false,
      message: "Nickindeki karakterlerden bir ya da birka√ß tanesi ge√ßersiz."
    };
  }*/

  if (!nickinOnundeSonundaBoslukVarMi) {
    return {
      return: false,
      message: "Adƒ±nƒ±n √∂n√ºnde veya sonunda bo≈üluk olamaz!"
    };
  }
  /*
  if (!(turnuvaGirisSayisi < 3)) {
    return {
      return: false,
      message: "Bir lig s√ºresi boyunca 3 defa giri≈ü √ßƒ±kƒ±≈ü yaptƒ±ƒüƒ±n ≈üu an girmen engellendi"
    };
  }*/

  return { return: true };
};

let oyuncuPlayerstaVarMi = function(id) {
  for (const player of players) {
    if (player.id === id) {
      return true;
    }
  }
  return false;
};

let oyuncuTakimliOyunculardaVarMi = function(id) {
  for (const item of takimliOyuncular) {
    if (id === item.playerId) {
      return true;
    }
  }
  return false;
};

let oyuncuYedekOyunculardaVarMi = function(id) {
  for (const item of yedekOyuncular) {
    if (id === item.id) {
      return true;
    }
  }
  return false;
};

let playerIdyeGoreTakimliOyuncuyuDondur = function(id) {
  for (const item of takimliOyuncular) {
    if (id === item.playerId) {
      return item;
    }
  }
  return false;
};

let idyeGoreTakimliOyuncuyuDondur = function(id) {
  for (const item of takimliOyuncular) {
    if (id === item.id) {
      return item;
    }
  }
  return false;
};

let takimIdyeGoreTakimliOyuncuyuDondur = function(id) {
  for (const item of takimliOyuncular) {
    if (id === item.takimId) {
      return item;
    }
  }
  return false;
};

let oyuncununTakiminiDondur = function(id) {
  for (const item of takimliOyuncular) {
    if (item.playerId === id) {
      return takimlar.find(x => x.id === item.takimId);
    }
  }
};

let oyuncuMesajGondersin = function(chat) {
  room.sendAnnouncement(chat.message, null, chat.color, chat.style, chat.sound);
  console.log(chat.message);
};

let buHaricHerkeseMesajGonder = function(id, chat) {
  for (const item of players) {
    if (item.id !== id) {
      room.sendAnnouncement(
        chat.message,
        item.id,
        chat.color,
        chat.style,
        chat.sound
      );
    }
  }
};

let oyuncuyaMesajGonder = function(id, chat) {
  room.sendAnnouncement(chat.message, id, chat.color, chat.style, chat.sound);
};

let belirliOyuncularaMesajGonder = function(idler, chat) {
  for (const id of idler) {
    room.sendAnnouncement(chat.message, id, chat.color, chat.style, chat.sound);
  }
};

let tumOyuncularaMesajGonder = function(chat) {
  room.sendAnnouncement(chat.message, null, chat.color, chat.style, chat.sound);
};

let istenenTakimiBaskasiAlmisMi = function(index) {
  for (const to of takimliOyuncular) {
    if (to.takimId === index) return true;
  }
  return false;
};

let oyuncununTakimiVarMi = function(id) {
  let todaVarMi = oyuncuTakimliOyunculardaVarMi(id);
  if (todaVarMi) {
    let takimliOyuncu = playerIdyeGoreTakimliOyuncuyuDondur(id);
    let takimId = takimliOyuncu.takimId;
    if (takimId) {
      return true;
    } else {
      return false;
    }
  }
  return false;
};

let oyuncuKomutlari = function(id, message) {
  if (message.startsWith("!ts")) {
    if (gameState === 0 && oyuncuTakimliOyunculardaVarMi(id)) {
      if (message.length === 5 || message.length === 6) {
        let sayi = (message[message.length - 2] +
          message[message.length - 1]).trim();
        sayi = Number(sayi);
        if (!isNaN(sayi)) {
          if (sayi > 0 && sayi < 21) {
            if (istenenTakimiBaskasiAlmisMi(sayi)) {
              let takim = takimiDondur(sayi).adi;
              oyuncuyaMesajGonder(
                id,
                hostMesajlari.baskasiSectiBildirimi(takim)
              );
            } else {
              let takimliOyuncu = playerIdyeGoreTakimliOyuncuyuDondur(id);
              takimliOyuncu.takimId = sayi;
              let takim = takimiDondur(sayi).adi;
              oyuncuyaMesajGonder(
                id,
                hostMesajlari.takimSectinBildirimi(takim)
              );

              let player = room.getPlayer(id);
              buHaricHerkeseMesajGonder(
                player.id,
                hostMesajlari.takimSecimiBildirimi(player.name, takim)
              );
              turnuvaKontrolu();
            }
          } else {
            oyuncuyaMesajGonder(id, hostMesajlari.tdKomutuKullanimi());
          }
        } else {
          oyuncuyaMesajGonder(id, hostMesajlari.tdKomutuKullanimi());
        }
      }
    } else {
      oyuncuyaMesajGonder(id, hostMesajlari.takimSecemezsin());
    }
  } else if (message === "!pd") {
    oyuncuyaMesajGonder(id, hostMesajlari.puanDurumu());
  } else if (message === "!evet") {
    if (dahilOlmaIslemi.dahilOlAktifMi) {
      let tgk = takimGirisleriKontrol.find(
        x => x.toId === dahilOlmaIslemi.dahilOlunanTOId
      );
      let idUygunMu = tgk.idler.find(x => x === id);
      if (idUygunMu) {
        tgk.kabulEdenler.push(id);
        let to = takimliOyuncular.find(x => x.id === tgk.toId);
        let takim = takimiDondur(to.takimId);
        oyuncuyaMesajGonder(id, hostMesajlari.onayiniAldik(takim.adi));
      } else {
        oyuncuyaMesajGonder(id, hostMesajlari.suanUygunDegil());
      }
    } else {
      oyuncuyaMesajGonder(id, hostMesajlari.suanUygunDegil());
    }
  } else if (message === "!f") {
    if (gameState > 1 && oyuncuTakimliOyunculardaVarMi(id)) {
      let mesaj = "";
      let to = takimliOyuncular.find(x => x.playerId === id);
      let oyuncununFiksturu = fikstur.filter(
        x => x.evSahibi === to.id || x.deplasman === to.id
      );
      for (const item of oyuncununFiksturu) {
        let evSahibiTakimTo = takimliOyuncular.find(
          x => x.id === item.evSahibi
        );
        let deplasmanTakimTo = takimliOyuncular.find(
          x => x.id === item.deplasman
        );
        let evSahibiTakim = takimiDondur(evSahibiTakimTo.takimId);
        let deplasmanTakim = takimiDondur(deplasmanTakimTo.takimId);
        let evSahibiSkor = item.evSahibiSkor;
        let deplasmanSkor = item.deplasmanSkor;
        let evSahibiPlayer = turnuvaZamaniOyunculari.find(
          x => x.id === evSahibiTakimTo.playerId
        );
        let deplasmanPlayer = turnuvaZamaniOyunculari.find(
          x => x.id === deplasmanTakimTo.playerId
        );

        if (!evSahibiPlayer) {
          evSahibiPlayer = turnuvaZamaniOyunculari.find(
            x => x.id === evSahibiTakimTo.oncekiPlayerId
          );
        }
        if (!deplasmanPlayer) {
          deplasmanPlayer = turnuvaZamaniOyunculari.find(
            x => x.id === deplasmanTakimTo.oncekiPlayerId
          );
        }
        if (evSahibiSkor === null) {
          evSahibiSkor = "";
        }
        if (deplasmanSkor === null) {
          deplasmanSkor = "";
        }

        let evSahibiTakimAdi =
          evSahibiTakim.adi + " (" + evSahibiPlayer.name + ")";
        let deplasmanTakimAdi =
          deplasmanTakim.adi + " (" + deplasmanPlayer.name + ")";
        let skor = evSahibiSkor + "-" + deplasmanSkor;

        mesaj +=
          item.hafta +
          ". Hafta " +
          evSahibiTakimAdi +
          " " +
          skor +
          " " +
          deplasmanTakimAdi +
          "\n";
      }
      oyuncuyaMesajGonder(id, hostMesajlari.fikstur(mesaj));
    } else {
      oyuncuyaMesajGonder(id, hostMesajlari.suanUygunDegil());
    }
  } else if (message === "!hf") {
    if (gameState > 1) {
      let mesaj = "";
      let suankiHafta = fikstur[fiksturSirasi].hafta;
      let haftalikFikstur = fikstur.filter(fiks => fiks.hafta === suankiHafta);
      for (const item of haftalikFikstur) {
        let evSahibiTakimTo = takimliOyuncular.find(
          x => x.id === item.evSahibi
        );
        let deplasmanTakimTo = takimliOyuncular.find(
          x => x.id === item.deplasman
        );
        let evSahibiTakim = takimiDondur(evSahibiTakimTo.takimId);
        let deplasmanTakim = takimiDondur(deplasmanTakimTo.takimId);
        let evSahibiSkor = item.evSahibiSkor;
        let deplasmanSkor = item.deplasmanSkor;
        let evSahibiPlayer = turnuvaZamaniOyunculari.find(
          x => x.id === evSahibiTakimTo.playerId
        );
        let deplasmanPlayer = turnuvaZamaniOyunculari.find(
          x => x.id === deplasmanTakimTo.playerId
        );

        if (!evSahibiPlayer) {
          evSahibiPlayer = turnuvaZamaniOyunculari.find(
            x => x.id === evSahibiTakimTo.oncekiPlayerId
          );
        }
        if (!deplasmanPlayer) {
          deplasmanPlayer = turnuvaZamaniOyunculari.find(
            x => x.id === deplasmanTakimTo.oncekiPlayerId
          );
        }
        if (evSahibiSkor === null) {
          evSahibiSkor = "";
        }
        if (deplasmanSkor === null) {
          deplasmanSkor = "";
        }
        let evSahibiTakimAdi =
          evSahibiTakim.adi + " (" + evSahibiPlayer.name + ")";
        let deplasmanTakimAdi =
          deplasmanTakim.adi + " (" + deplasmanPlayer.name + ")";
        let skor = evSahibiSkor + "-" + deplasmanSkor;

        mesaj +=
          suankiHafta +
          ". Hafta " +
          evSahibiTakimAdi +
          " " +
          skor +
          " " +
          deplasmanTakimAdi +
          "\n";
      }
      oyuncuyaMesajGonder(id, hostMesajlari.fikstur(mesaj));
    } else {
      oyuncuyaMesajGonder(id, hostMesajlari.suanUygunDegil());
    }
  } else if (message === "!ut") {
    let oyuncuYedeklerdeVarMi = oyuncuYedekOyunculardaVarMi(id);
    if (gameState === 0 && !oyuncuYedeklerdeVarMi) {
      oyuncuyaMesajGonder(id, hostMesajlari.uygunTakimlar());
    }
  } else if (message.startsWith("!dc")) {
    oyuncuyaMesajGonder(id, hostMesajlari.discord());
  } else if (message.startsWith("!komutlar")) {
    oyuncuyaMesajGonder(id, hostMesajlari.komutlar());
  } else {
    oyuncuyaMesajGonder(id, hostMesajlari.boyleBirKomutYok());
  }
};

let oyuncuMesajKontrol = function(player, message = "") {
  message = message.toLocaleLowerCase().trim();

  if (message.startsWith("!")) {
    oyuncuKomutlari(player.id, message);
  } else {
    if (
      oyuncuTakimliOyunculardaVarMi(player.id) &&
      !oyuncununTakimiVarMi(player.id)
    ) {
      oyuncuyaMesajGonder(player.id, hostMesajlari.takimSec());
    } else if (
      oyuncuTakimliOyunculardaVarMi(player.id) &&
      oyuncununTakimiVarMi(player.id)
    ) {
      let mesajUygunlugu = mesajGecerliMi(message);
      if (mesajUygunlugu.return) {
        if (chatMessageSayisi > 4) {
          oyuncuyaMesajGonder(player.id, hostMesajlari.yavaslatilmisMod());
        } else {
          let takim = oyuncununTakiminiDondur(player.id);
          let takimAdi = takim.adi;
          oyuncuMesajGondersin(
            hostMesajlari.oyuncuMesaji(player, message, takimAdi)
          );
          chatMessageSayisi++;
        }
      } else {
        if (mesajUygunlugu.message) {
          oyuncuyaMesajGonder(
            player.id,
            hostMesajlari.mesajGonderilemedi(mesajUygunlugu.message)
          );
        }
      }
    } else {
      let mesajUygunlugu = mesajGecerliMi(message);
      if (mesajUygunlugu.return) {
        if (chatMessageSayisi > 4) {
          oyuncuyaMesajGonder(player.id, hostMesajlari.yavaslatilmisMod());
        } else {
          let takimAdi = "Bo≈üta";
          oyuncuMesajGondersin(
            hostMesajlari.oyuncuMesaji(player, message, takimAdi)
          );
          chatMessageSayisi++;
        }
      } else {
        if (mesajUygunlugu.message) {
          oyuncuyaMesajGonder(
            player.id,
            hostMesajlari.mesajGonderilemedi(mesajUygunlugu.message)
          );
        }
      }
    }
  }
};

let takimliOyuncularHazirMi = function() {
  for (const item of takimliOyuncular) {
    if (item.playerId === null || item.takimId === null) {
      return false;
    }
  }
  return true;
};

let maciBaslat = function() {
  oyunculariSpeceAt();
  let evSahibi = idyeGoreTakimliOyuncuyuDondur(fikstur[fiksturSirasi].evSahibi);
  let deplasman = idyeGoreTakimliOyuncuyuDondur(
    fikstur[fiksturSirasi].deplasman
  );
  let evSahibiTakim = takimiDondur(evSahibi.takimId);
  let deplasmanTakim = takimiDondur(deplasman.takimId);
  let evSahibiRenk = evSahibiTakim.renkler;
  let deplasmanRenk = deplasmanTakim.renkler;

  room.setDefaultStadium("Classic");
  room.setPlayerTeam(evSahibi.playerId, 1);
  room.setPlayerTeam(deplasman.playerId, 2);
  room.setTeamColors(
    1,
    evSahibiRenk.angle,
    evSahibiRenk.textColor,
    evSahibiRenk.colors
  );
  room.setTeamColors(
    2,
    deplasmanRenk.angle,
    deplasmanRenk.textColor,
    deplasmanRenk.colors
  );
  room.setPlayerAvatar(
    evSahibi.playerId,
    evSahibiTakim.kisaAdi.substring(0, 2)
  );
  room.setPlayerAvatar(
    deplasman.playerId,
    deplasmanTakim.kisaAdi.substring(0, 2)
  );
  room.startGame();
};

let geciktir = async function (func, time) {
  new Promise(() => {
    setTimeout(func, time);
  });
}

let turnuvaKontrolu = function() {
  if (takimliOyuncularHazirMi() && gameState === 0) {
    room.stopGame();
    fiksturSirasi = 0;
    gameState = 1;
    oyunculariSpeceAt();
    geciktir(turnuvayiBaslat, 2000);
  }
};

let turnuvayiBaslat = function() {
  fiksturuAyarla();
  maciBaslat();
  tumOyuncularaMesajGonder(hostMesajlari.ligBasliyor());
  dahilOlPromise();
};

let fiksturuAyarla = function() {
  fikstur = [
    {
      hafta: 1,
      evSahibi: -1,
      deplasman: -2,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 1,
      evSahibi: -3,
      deplasman: -4,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 1,
      evSahibi: -5,
      deplasman: -6,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 2,
      evSahibi: -5,
      deplasman: -3,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 2,
      evSahibi: -6,
      deplasman: -1,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 2,
      evSahibi: -4,
      deplasman: -2,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 3,
      evSahibi: -1,
      deplasman: -4,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 3,
      evSahibi: -2,
      deplasman: -5,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 3,
      evSahibi: -6,
      deplasman: -3,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 4,
      evSahibi: -2,
      deplasman: -6,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 4,
      evSahibi: -4,
      deplasman: -5,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 4,
      evSahibi: -3,
      deplasman: -1,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 5,
      evSahibi: -6,
      deplasman: -4,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 5,
      evSahibi: -5,
      deplasman: -1,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 5,
      evSahibi: -2,
      deplasman: -3,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 6,
      evSahibi: -2,
      deplasman: -1,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 6,
      evSahibi: -4,
      deplasman: -3,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 6,
      evSahibi: -6,
      deplasman: -5,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 7,
      evSahibi: -3,
      deplasman: -5,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 7,
      evSahibi: -1,
      deplasman: -6,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 7,
      evSahibi: -2,
      deplasman: -4,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 8,
      evSahibi: -4,
      deplasman: -1,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 8,
      evSahibi: -5,
      deplasman: -2,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 8,
      evSahibi: -3,
      deplasman: -6,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 9,
      evSahibi: -6,
      deplasman: -2,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 9,
      evSahibi: -5,
      deplasman: -4,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 9,
      evSahibi: -1,
      deplasman: -3,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 10,
      evSahibi: -4,
      deplasman: -6,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 10,
      evSahibi: -1,
      deplasman: -5,
      evSahibiSkor: null,
      deplasmanSkor: null
    },
    {
      hafta: 10,
      evSahibi: -3,
      deplasman: -2,
      evSahibiSkor: null,
      deplasmanSkor: null
    }
  ];
  let toIds = [1, 2, 3, 4, 5, 6].sort(
    (a, b) => (Math.floor(Math.random() * 2) === 0 ? 1 : -1)
  );

  for (const item of fikstur) {
    let valueEv = item.evSahibi + 6;
    let valueDep = item.deplasman + 6;

    for (let index = 0; index < toIds.length; index++) {
      if (valueEv === index) {
        item.evSahibi = toIds[index];
      } else if (valueDep === index) {
        item.deplasman = toIds[index];
      }
    }
  }
};

let takimliOyunculariVeYedekleriAyarla = function() {
  let toyaEklenecekOyuncular = [];
  let yedekSayisi = yedekOyuncular.length;
  if (yedekSayisi > 0) {
    if (yedekSayisi < 6) {
      let kalan = 6 - yedekSayisi;
      kalan =
        players.length - yedekSayisi < kalan
          ? players.length - yedekSayisi
          : kalan;

      for (let index = 0; index < yedekSayisi; index++) {
        toyaEklenecekOyuncular.push({ ...yedekOyuncular[index] });
      }
      for (let index = 0; index < yedekSayisi; index++) {
        yedekOyuncular.splice(0, 1);
      }
      let toyaEklenecekOyuncularIds = [];
      for (const item of toyaEklenecekOyuncular) {
        toyaEklenecekOyuncularIds.push(item.id);
      }
      let playersIds = [];
      for (const item of players) {
        playersIds.push(item.id);
      }
      let idler = playersIds.filter(
        x => !toyaEklenecekOyuncularIds.includes(x)
      );

      for (let index = 0; index < kalan; index++) {
        let player = players.find(x => x.id === idler[index]);
        toyaEklenecekOyuncular.push({ ...player });
        toyaEklenecekOyuncularIds.push(player.id);
      }
      idler = playersIds.filter(x => !toyaEklenecekOyuncularIds.includes(x));
      yedekOyuncular = [];
      for (let index = 0; index < idler.length; index++) {
        let player = players.find(x => x.id === idler[index]);
        yedekOyuncular.push({ ...player });
      }
    } else {
      for (let index = 0; index < 6; index++) {
        toyaEklenecekOyuncular.push({ ...yedekOyuncular[index] });
      }
      for (let index = 0; index < 6; index++) {
        yedekOyuncular.splice(0, 1);
      }
      let toIds = [];
      for (const item of toyaEklenecekOyuncular) {
        toIds.push(item.id);
      }
      let tumOyuncularIds = [];
      for (const item of players) {
        tumOyuncularIds.push(item.id);
      }
      let idler = tumOyuncularIds.filter(x => !toIds.includes(x));
      for (let index = 0; index < idler.length; index++) {
        let player = players.find(x => x.id === idler[index]);
        let oyuncuYedeklerdeVarMi = oyuncuYedekOyunculardaVarMi(player.id);
        if (!oyuncuYedeklerdeVarMi) {
          yedekOyuncular.push({ ...player });
        }
      }
    }
  } else {
    for (const item of players) {
      toyaEklenecekOyuncular.push({ ...item });
    }
  }

  for (let index = 0; index < toyaEklenecekOyuncular.length; index++) {
    takimliOyuncular[index].playerId = toyaEklenecekOyuncular[index].id;
    oyuncuyaMesajGonder(
      takimliOyuncular[index].playerId,
      hostMesajlari.simdiTakimSec()
    );
    oyuncuyaMesajGonder(
      takimliOyuncular[index].playerId,
      hostMesajlari.uygunTakimlar()
    );
    takimSecPromise(takimliOyuncular[index].playerId);
  }
};

let skoruSifirla = function() {
  skor = { red: 0, blue: 0 };
};

let clearTimeouts = function() {
  clearTimeout(dahilOlTimeouts.dahilOlPromise);
  clearTimeout(dahilOlTimeouts.takimGirisKontrol);
};

let turnuvaZamaniOyunculariniYenile = function() {
  let turnuvaZamaniOyunculariIds = [];
  let playersIds = [];

  for (const item of turnuvaZamaniOyunculari) {
    turnuvaZamaniOyunculariIds.push(item.id);
  }

  for (const item of players) {
    playersIds.push(item.id);
  }

  let kalanOyuncular = turnuvaZamaniOyunculariIds.filter(x =>
    playersIds.includes(x)
  );
  let yeniTurnuvaZamaniOyunculari = [];
  for (const item of kalanOyuncular) {
    let player = turnuvaZamaniOyunculari.find(x => x.id === item);
    yeniTurnuvaZamaniOyunculari.push({ ...player });
  }
  turnuvaZamaniOyunculari = yeniTurnuvaZamaniOyunculari;
};

let oyunuSifirla = function() {
  takimGirisleriKontrol = takimGirisKontrolOlustur();
  clearTimeouts();
  dahilOlTimeouts = dahilOlTimeoutsOlustur();
  dahilOlmaIslemi = dahilOlmaIslemiOlustur();
  let fakeTakimliOyuncular = [];
  for (const item of takimliOyuncular) {
    fakeTakimliOyuncular.push({ ...item });
  }
  takimliOyuncular = takimliOyuncularOlustur();
  fikstur = [];
  fiksturSirasi = -1;
  takimPuanDurumu = puanDurumuOlustur();
  takimliOyunculariVeYedekleriAyarla(fakeTakimliOyuncular);
  turnuvaZamaniOyunculariniYenile();
  skoruSifirla();
  gameState = 0;
  geciciOyunculariYerlestir();
  geciciOyun();
};

let idyeGorePuanDurumuObjDondur = function(id) {
  return takimPuanDurumu.find(x => x.toId === id);
};

let oyunculariSpeceAt = function() {
  for (const item of players) {
    room.setPlayerTeam(item.id, 0);
  }
};

let puanDurumunuDuzenle = function() {
  takimPuanDurumu.sort((a, b) => b.p - a.p);
  takimPuanDurumu.sort((a, b) => {
    if (b.p === a.p) {
      return b.a - a.a;
    }
  });

  takimPuanDurumu.sort((a, b) => {
    if (b.p === a.p) {
      let tpdObjs = takimPuanDurumu.filter(x => x.p === a.p);
      let tpdObjsIds = [];
      let yeniFikstur = [];
      let yeniPuanDurumu = [];

      for (const item of tpdObjs) {
        tpdObjsIds.push(item.toId);
      }

      for (let index = 0; index < tpdObjsIds.length; index++) {
        for (let index2 = 0; index2 < tpdObjsIds.length; index2++) {
          if (tpdObjsIds[index] !== tpdObjsIds[index2]) {
            let fiks = {
              evSahibi: tpdObjsIds[index],
              deplasman: tpdObjsIds[index2]
            };
            yeniFikstur.push(fiks);
          }
        }
      }

      for (const item of tpdObjsIds) {
        let takimPuanDurumuObj = {
          toId: item,
          o: 0,
          g: 0,
          b: 0,
          m: 0,
          ag: 0,
          yg: 0,
          a: 0,
          p: 0
        };
        yeniPuanDurumu.push(takimPuanDurumuObj);
      }

      for (const fiks of fikstur) {
        for (const fiks2 of yeniFikstur) {
          if (
            fiks.evSahibi === fiks2.evSahibi &&
            fiks.deplasman === fiks2.deplasman
          ) {
            let evSahibiSkor =
              fiks.evSahibiSkor === null ? 0 : fiks.evSahibiSkor;
            let deplasmanSkor =
              fiks.deplasmanSkor === null ? 0 : fiks.deplasmanSkor;
            let evSahibiTakimPuanDurumuObj = yeniPuanDurumu.find(
              x => x.toId === fiks.evSahibi
            );
            let deplasmanTakimPuanDurumuObj = yeniPuanDurumu.find(
              x => x.toId === fiks.deplasman
            );
            evSahibiTakimPuanDurumuObj.o++;
            deplasmanTakimPuanDurumuObj.o++;
            evSahibiTakimPuanDurumuObj.ag += evSahibiSkor;
            evSahibiTakimPuanDurumuObj.yg += deplasmanSkor;
            deplasmanTakimPuanDurumuObj.ag += deplasmanSkor;
            deplasmanTakimPuanDurumuObj.yg += evSahibiSkor;
            evSahibiTakimPuanDurumuObj.a +=
              evSahibiTakimPuanDurumuObj.ag - evSahibiTakimPuanDurumuObj.yg;
            deplasmanTakimPuanDurumuObj.a +=
              deplasmanTakimPuanDurumuObj.ag - deplasmanTakimPuanDurumuObj.yg;

            if (evSahibiSkor > deplasmanSkor) {
              evSahibiTakimPuanDurumuObj.p += 3;
              evSahibiTakimPuanDurumuObj.g++;
              deplasmanTakimPuanDurumuObj.m++;
            } else if (evSahibiSkor === deplasmanSkor) {
              evSahibiTakimPuanDurumuObj.p += 1;
              deplasmanTakimPuanDurumuObj.p += 1;
              evSahibiTakimPuanDurumuObj.b++;
              deplasmanTakimPuanDurumuObj.b++;
            } else if (evSahibiSkor < deplasmanSkor) {
              deplasmanTakimPuanDurumuObj.p += 3;
              evSahibiTakimPuanDurumuObj.m++;
              deplasmanTakimPuanDurumuObj.g++;
            }
          }
        }
      }
      yeniPuanDurumu.sort((a, b) => b.p - a.p);
      yeniPuanDurumu.sort((a, b) => {
        if (b.p === a.p) {
          return b.a - a.a;
        }
      });

      let aIndex = yeniPuanDurumu.findIndex(x => x.toId === a.toId);
      let bIndex = yeniPuanDurumu.findIndex(x => x.toId === b.toId);
      if (aIndex > bIndex) {
        return 1;
      }
      if (aIndex < bIndex) {
        return -1;
      }
    }
  });

  let sira = 0;
  let tabloString =
    "----------------------- PUAN DURUMU ----------------------- \n";
  for (const item of takimPuanDurumu) {
    let takimliOyuncu = idyeGoreTakimliOyuncuyuDondur(item.toId);
    let takim = takimiDondur(takimliOyuncu.takimId);
    let oyuncu = turnuvaZamaniOyunculari.find(
      x => x.id === takimliOyuncu.playerId
    );
    if (!oyuncu) {
      oyuncu = turnuvaZamaniOyunculari.find(
        x => x.id === takimliOyuncu.oncekiPlayerId
      );
    }
    let row =
      sira +
      1 +
      ") " +
      takim.adi +
      " (" +
      oyuncu.name +
      ") " +
      " O: " +
      item.o +
      " G: " +
      item.g +
      " B: " +
      item.b +
      " M: " +
      item.m +
      " AG: " +
      item.ag +
      " YG: " +
      item.yg +
      " A: " +
      item.a +
      " P: " +
      item.p +
      "\n";
    tabloString += row;
    sira++;
  }

  puanDurumuString = tabloString;
};

let macSonuclariniGir = function() {};

let kutlama = function(index = 0) {
  let kutlamalar = [
    "üèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜ",
    "üèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖüèÖ",
    "üèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜüèÜ",
    "üòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòéüòé",
    "ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©ü§©"
  ];

  let sampiyonTo = takimliOyuncular.find(x => x.id === takimPuanDurumu[0].toId);
  let sampiyon = turnuvaZamaniOyunculari.find(
    x => x.id === sampiyonTo.playerId
  );
  if (!sampiyon) {
    sampiyon = turnuvaZamaniOyunculari.find(
      x => x.id === sampiyonTo.oncekiPlayerId
    );
  }
  let sampiyonunAdi = sampiyon.name;
  let sampiyonTakiminAdi = takimiDondur(sampiyonTo.takimId).adi;

  if (index === 10) {
    oyunuSifirla();
    return;
  }
  let kutlamaMesaji = `${kutlamalar[index % 5]}
                                     üèÜüèÜüèÜ ≈ûAMPƒ∞YON ${sampiyonunAdi.toLocaleUpperCase()} üèÜüèÜüèÜ

                                     üèÜüèÜüèÜ ≈ûAMPƒ∞YON ${sampiyonTakiminAdi.toLocaleUpperCase()} üèÜüèÜüèÜ
${kutlamalar[index % 5]}`;
  tumOyuncularaMesajGonder(hostMesajlari.kutlama(kutlamaMesaji));
  setTimeout(() => kutlama(index + 1), 1000);
};

let takimSecPromise = async function(id) {
  new Promise(() => {
    setTimeout(() => {
      let to = takimliOyuncular.find(x => x.playerId === id);
      if (to) {
        if (to.takimId === null) {
          let uygunTakimIdsi = uygunTakimlariDondur()[0];
          let uygunTakim = takimiDondur(uygunTakimIdsi);
          to.takimId = uygunTakim.id;
          oyuncuyaMesajGonder(
            to.playerId,
            hostMesajlari.yeniTakim(uygunTakim.adi)
          );
          turnuvaKontrolu();
        }
      }
    }, 10000);
  });
};

let takimGirisKontrol = function() {
  dahilOlmaIslemi.dahilOlAktifMi = false;
  let tgk = takimGirisleriKontrol.find(
    x => x.toId === dahilOlmaIslemi.dahilOlunanTOId
  );
  let kabulEtmeyenler = tgk.idler.filter(x => !tgk.kabulEdenler.includes(x));
  tgk.kabulEtmeyenler.push(...kabulEtmeyenler);
  tgk.kabulEtmeyenler = Array.from(new Set(tgk.kabulEtmeyenler));
  tgk.kabulEdenler = tgk.idler.filter(x => tgk.kabulEdenler.includes(x));
  tgk.idler = [];
  let to = takimliOyuncular.find(x => x.id === tgk.toId);
  let player = null;
  for (const item of tgk.kabulEdenler) {
    player = players.find(x => x.id === item);
    if (player) {
      break;
    }
  }
  if (player) {
    let yedekIndex = yedekOyuncular.findIndex(x => x.id === player.id);
    yedekOyuncular.splice(yedekIndex, 1);
    to.playerId = player.id;
    let takim = takimiDondur(to.takimId).adi;
    oyuncuyaMesajGonder(player.id, hostMesajlari.takimSectinBildirimi(takim));
    buHaricHerkeseMesajGonder(
      player.id,
      hostMesajlari.takimSecimiBildirimi(player.name, takim)
    );
  }
  tgk.kabulEdenler = [];
};

let dahilOlPromise = async function() {
  if (gameState > 1 && gameState < 4) {
    let uygunTolar = takimliOyuncular.filter(x => x.playerId === null);
    let uygunTo =
      uygunTolar.length > 0
        ? uygunTolar.sort((a, b) => {
            let aIndex = takimPuanDurumu.findIndex(y => y.toId === a.id);
            let bIndex = takimPuanDurumu.findIndex(y => y.toId === b.id);
            if (bIndex > aIndex) {
              return -1;
            }
            if (bIndex < aIndex) {
              return 1;
            }
          })[0]
        : null;
    let uygunToIndex = uygunTo
      ? takimPuanDurumu.findIndex(x => x.toId === uygunTo.id)
      : null;
    if (uygunTo) {
      let yedekOyuncularIds = [];
      for (const item of yedekOyuncular) {
        yedekOyuncularIds.push(item.id);
      }
      dahilOlmaIslemi.dahilOlAktifMi = true;
      dahilOlmaIslemi.dahilOlunanTOId = uygunTo.id;
      let tgk = takimGirisleriKontrol.find(x => x.toId === uygunTo.id);
      tgk.idler = yedekOyuncularIds.filter(
        x => !tgk.kabulEtmeyenler.includes(x)
      );
      let sira = uygunToIndex + 1;
      let hafta = fikstur[fiksturSirasi].hafta;
      let takim = takimiDondur(uygunTo.takimId);
      if (tgk.idler.length > 0) {
        belirliOyuncularaMesajGonder(
          tgk.idler,
          hostMesajlari.dahilOlabilirsin(takim.adi, hafta, sira)
        );
        new Promise(() => {
          dahilOlTimeouts.takimGirisKontrol = setTimeout(
            takimGirisKontrol,
            10000
          );
        });
      }
    }
  }
  new Promise(() => {
    dahilOlTimeouts.dahilOlPromise = setTimeout(dahilOlPromise, 20000);
  });
};

let pointDistance = function(p1, p2) {
  let d1 = p1.x - p2.x;
  let d2 = p1.y - p2.y;
  return Math.sqrt(d1 * d1 + d2 * d2);
};

let topaDokunmaKontrol = function() {
  let ballPosition = room.getBallPosition();
  let ballRadius = 10; // 6.4
  let playerRadius = 15;
  let triggerDistance = ballRadius + playerRadius + 0.01;

  let redId = takimliOyuncular.find(
    x => x.id === fikstur[fiksturSirasi].evSahibi
  ).playerId;
  let blueId = takimliOyuncular.find(
    x => x.id === fikstur[fiksturSirasi].deplasman
  ).playerId;

  let oyuncular = room.getPlayerList();

  let oyundakiOyuncular = oyuncular.filter(
    player => player.id === redId || player.id === blueId
  );

  for (let i = 0; i < oyundakiOyuncular.length; i++) {
    let player = oyundakiOyuncular[i];

    if (player.position === null) continue;

    let distanceToBall = pointDistance(player.position, ballPosition);

    if (player.team === 1) {
      if (distanceToBall < triggerDistance) {
        topaDokunmaKontrolu.red++;
      }
    } else if (player.team === 2) {
      if (distanceToBall < triggerDistance) {
        topaDokunmaKontrolu.blue++;
      }
    }
  }
};

let oyunuBaslatKontrol = async function(team, to, time) {
  new Promise(() => {
    oyunuBaslatmaKontrolu.timeout = setTimeout(() => {
      let dokunmaSayisi =
        team === 1 ? topaDokunmaKontrolu.red : topaDokunmaKontrolu.blue;
      let player = players.find(x => x.id === to.playerId);
      if (dokunmaSayisi < 1) {
        if (player) {
          room.kickPlayer(
            player.id,
            "10 saniye i√ßinde ba≈ülamadƒ±ƒüƒ±n i√ßin atƒ±ldƒ±n",
            false
          );
        }
      }
    }, time);
  });
  if (to.playerId) {
    oyuncuyaMesajGonder(to.playerId, hostMesajlari.oyunaBasla());
  }
};

let topaDokunmaKontroluSifirla = function() {
  topaDokunmaKontrolu = { red: 0, blue: 0 };
};

let kendiKalesineGolAtmaKontroluSifirla = function() {
  kendiKalesineGolAtmaKontrolu = { red: 0, blue: 0 };
};

let oyunuBaslatmaKontroluSifirla = function() {
  clearTimeout(oyunuBaslatmaKontrolu.timeout);
  oyunuBaslatmaKontrolu.timeout = null;
};

let onPlayerJoin = function(player) {
  let gecerlilik = oyuncuGecerliMi(player);

  if (gecerlilik.return) {
    players.push({ ...player });
    turnuvaZamaniOyunculari.push({ ...player });
    oyuncuyaMesajGonder(player.id, hostMesajlari.hosgeldin(player.name));
  } else {
    setTimeout(
      () => room.kickPlayer(player.id, gecerlilik.message, false),
      3000
    );
    return;
  }

  if (gameState === 0) {
    let roomPlayers = room.getPlayerList();
    let redSayisi = 0;
    let blueSayisi = 0;
    for (let index = 0; index < roomPlayers.length; index++) {
      if(roomPlayers[index].team === 1){
        redSayisi++;
      }
      if(roomPlayers[index].team === 2){
        blueSayisi++;
      }
      
    }
    if(redSayisi <= blueSayisi){
      room.setPlayerTeam(player.id, 1);
    }
    else {
      room.setPlayerTeam(player.id, 2);
    }

    if (yedekOyuncular.length > 0) {
      yedekOyuncular.push({ ...player });
    } else {
      let takimliOyuncu = uygunTakimliOyuncuDondur();
      if (takimliOyuncu) {
        takimliOyuncu.playerId = player.id;
        oyuncuyaMesajGonder(
          takimliOyuncu.playerId,
          hostMesajlari.simdiTakimSec()
        );
        oyuncuyaMesajGonder(
          takimliOyuncu.playerId,
          hostMesajlari.uygunTakimlar()
        );
        takimSecPromise(takimliOyuncu.playerId);
      } else {
        yedekOyuncular.push({ ...player });
      }
    }
  } else {
    yedekOyuncular.push({ ...player });
  }
};

let onPlayerLeave = function(player) {
  if (oyuncuYedekOyunculardaVarMi(player.id)) {
    yedekOyuncular = yedekOyuncular.filter(x => x.id !== player.id);
  }

  if (oyuncuPlayerstaVarMi(player.id)) {
    players = players.filter(x => x.id !== player.id);
  }

  if (oyuncuTakimliOyunculardaVarMi(player.id)) {
    let takimliOyuncu = playerIdyeGoreTakimliOyuncuyuDondur(player.id);
    if (takimliOyuncu) {
      takimliOyuncu.oncekiPlayerId = takimliOyuncu.playerId;
      takimliOyuncu.playerId = null;
      if (gameState === 0) {
        takimliOyuncu.takimId = null;
      }
      if (gameState === 3) {
        let evSahibi = fikstur[fiksturSirasi].evSahibi;
        let deplasman = fikstur[fiksturSirasi].deplasman;

        if (takimliOyuncu.id === evSahibi || takimliOyuncu.id === deplasman) {
          if (evSahibi === takimliOyuncu.id) {
            if (skor.blue - skor.red < 3) {
              skor.red = 0;
              skor.blue = 3;
            }
          }
          if (deplasman === takimliOyuncu.id) {
            if (skor.red - skor.blue < 3) {
              skor.red = 3;
              skor.blue = 0;
            }
          }
          tumOyuncularaMesajGonder(
            hostMesajlari.hukmenMaglup(
              player.name,
              takimiDondur(takimliOyuncu.takimId).adi
            )
          );
          room.stopGame();
        }
      }
    }
    if (gameState === 0 && yedekOyuncular.length > 0) {
      takimliOyuncu.playerId = yedekOyuncular[0].id;
      takimliOyuncu.takimId = null;
      yedekOyuncular.splice(0, 1);
      oyuncuyaMesajGonder(
        takimliOyuncu.playerId,
        hostMesajlari.simdiTakimSec()
      );
      oyuncuyaMesajGonder(
        takimliOyuncu.playerId,
        hostMesajlari.uygunTakimlar()
      );
      takimSecPromise(takimliOyuncu.playerId);
    }
  }
};

let onPlayerChat = function(player, message) {
  if (oyuncuPlayerstaVarMi(player.id)) {
    oyuncuMesajKontrol(player, message);
  }
  return false;
};

let onPlayerKicked = function(player, reason, ban, byPlayer) {};

let onPlayerBallKick = function(player) {
  if (gameState === 3) {
    if (player.team === 1) {
      topaDokunmaKontrolu.red++;
    } else if (player.team === 2) {
      topaDokunmaKontrolu.blue++;
    }
  }
};

let onGameStart = function(byPlayer) {
  if (gameState !== 0) {
    gameState = 3;
    oyunuBaslatKontrol(
      1,
      takimliOyuncular.find(x => x.id === fikstur[fiksturSirasi].evSahibi),
      10000
    );
    let hafta = fikstur[fiksturSirasi].hafta;
    let evSahibiTo = takimliOyuncular.find(
      x => x.id === fikstur[fiksturSirasi].evSahibi
    );
    let deplasmanTo = takimliOyuncular.find(
      x => x.id === fikstur[fiksturSirasi].deplasman
    );
    let evSahibi = players.find(x => x.id === evSahibiTo.playerId);
    let deplasman = players.find(x => x.id === deplasmanTo.playerId);

    if (!evSahibi) {
      evSahibi = turnuvaZamaniOyunculari.find(
        x => x.id === evSahibiTo.oncekiPlayerId
      );
    }
    if (!deplasman) {
      deplasman = turnuvaZamaniOyunculari.find(
        x => x.id === deplasmanTo.oncekiPlayerId
      );
    }

    let evSahibiTamAd =
      takimiDondur(evSahibiTo.takimId).adi + " (" + evSahibi.name + ")";
    let deplasmanTamAd =
      takimiDondur(deplasmanTo.takimId).adi + " (" + deplasman.name + ")";

    if (evSahibiTo.playerId && !deplasmanTo.playerId) {
      skor.red = 3;
      skor.blue = 0;
      tumOyuncularaMesajGonder(
        hostMesajlari.hukmenKazaniyor(hafta, evSahibiTamAd, deplasmanTamAd)
      );
      room.stopGame();
    } else if (!evSahibiTo.playerId && deplasmanTo.playerId) {
      skor.red = 0;
      skor.blue = 3;
      tumOyuncularaMesajGonder(
        hostMesajlari.hukmenKazaniyor(hafta, deplasmanTamAd, evSahibiTamAd)
      );
      room.stopGame();
    } else if (!evSahibiTo.playerId && !evSahibiTo.playerId) {
      skor.red = 0;
      skor.blue = 0;
      tumOyuncularaMesajGonder(
        hostMesajlari.berabereBitiyor(hafta, evSahibiTamAd, deplasmanTamAd)
      );
      room.stopGame();
    } else {
      tumOyuncularaMesajGonder(
        hostMesajlari.macBasladi(hafta, evSahibiTamAd, deplasmanTamAd)
      );
    }
  }
};

let onGameStop = function(byPlayer) {
  if (gameState !== 0 && gameState !== 1) {
    gameState = 2;
    let evSahibi = idyeGoreTakimliOyuncuyuDondur(
      fikstur[fiksturSirasi].evSahibi
    );
    let deplasman = idyeGoreTakimliOyuncuyuDondur(
      fikstur[fiksturSirasi].deplasman
    );
    let evSahibiPuanDurumu = idyeGorePuanDurumuObjDondur(evSahibi.id);
    let deplasmanPuanDurumu = idyeGorePuanDurumuObjDondur(deplasman.id);

    fikstur[fiksturSirasi].evSahibiSkor = skor.red;
    fikstur[fiksturSirasi].deplasmanSkor = skor.blue;

    if (skor.red > skor.blue) {
      evSahibiPuanDurumu.o++;
      evSahibiPuanDurumu.g++;
      evSahibiPuanDurumu.ag += skor.red;
      evSahibiPuanDurumu.yg += skor.blue;
      evSahibiPuanDurumu.a = evSahibiPuanDurumu.ag - evSahibiPuanDurumu.yg;
      evSahibiPuanDurumu.p += 3;

      deplasmanPuanDurumu.o++;
      deplasmanPuanDurumu.m++;
      deplasmanPuanDurumu.ag += skor.blue;
      deplasmanPuanDurumu.yg += skor.red;
      deplasmanPuanDurumu.a = deplasmanPuanDurumu.ag - deplasmanPuanDurumu.yg;
      deplasmanPuanDurumu.p += 0;
    } else if (skor.red === skor.blue) {
      evSahibiPuanDurumu.o++;
      evSahibiPuanDurumu.b++;
      evSahibiPuanDurumu.ag += skor.red;
      evSahibiPuanDurumu.yg += skor.blue;
      evSahibiPuanDurumu.a = evSahibiPuanDurumu.ag - evSahibiPuanDurumu.yg;
      evSahibiPuanDurumu.p += 1;

      deplasmanPuanDurumu.o++;
      deplasmanPuanDurumu.b++;
      deplasmanPuanDurumu.ag += skor.blue;
      deplasmanPuanDurumu.yg += skor.red;
      deplasmanPuanDurumu.a = deplasmanPuanDurumu.ag - deplasmanPuanDurumu.yg;
      deplasmanPuanDurumu.p += 1;
    } else if (skor.red < skor.blue) {
      evSahibiPuanDurumu.o++;
      evSahibiPuanDurumu.m++;
      evSahibiPuanDurumu.ag += skor.red;
      evSahibiPuanDurumu.yg += skor.blue;
      evSahibiPuanDurumu.a = evSahibiPuanDurumu.ag - evSahibiPuanDurumu.yg;
      evSahibiPuanDurumu.p += 0;

      deplasmanPuanDurumu.o++;
      deplasmanPuanDurumu.g++;
      deplasmanPuanDurumu.ag += skor.blue;
      deplasmanPuanDurumu.yg += skor.red;
      deplasmanPuanDurumu.a = deplasmanPuanDurumu.ag - deplasmanPuanDurumu.yg;
      deplasmanPuanDurumu.p += 3;
    }

    oyunuBaslatmaKontroluSifirla();
    kendiKalesineGolAtmaKontroluSifirla();
    topaDokunmaKontroluSifirla();
    skoruSifirla();
    puanDurumunuDuzenle();
    oyunculariSpeceAt();

    fiksturSirasi++;

    if (fiksturSirasi < 30) {
      maciBaslat();
    } else if (fiksturSirasi === 30) {
      gameState = 4;
      kutlama();
    }
  }
};

let onGameTick = function() {
  if (gameState === 3) {
    topaDokunmaKontrol();
    let scores = room.getScores();
    let time = Math.floor(scores.time);

    if (time >= gameTime) room.stopGame();
  }
};

let onTeamGoal = function(team) {
  if (gameState !== 0) {
    oyunuBaslatmaKontroluSifirla();
    let evSahibiTo = takimliOyuncular.find(
      x => x.id === fikstur[fiksturSirasi].evSahibi
    );
    let deplasmanTo = takimliOyuncular.find(
      x => x.id === fikstur[fiksturSirasi].deplasman
    );
    let evSahibiPlayer = players.find(x => x.id === evSahibiTo.playerId);
    let deplasmanPlayer = players.find(x => x.id === deplasmanTo.playerId);
    if (team === 1) {
      if (topaDokunmaKontrolu.red === 0) {
        kendiKalesineGolAtmaKontrolu.blue++;
        if (kendiKalesineGolAtmaKontrolu.blue === 2) {
          if (deplasmanPlayer) {
            oyuncuyaMesajGonder(
              deplasmanPlayer.id,
              hostMesajlari.atilacaksin()
            );
            buHaricHerkeseMesajGonder(
              deplasmanPlayer.id,
              hostMesajlari.oyuncuAtilacak(deplasmanPlayer.name)
            );
          }
        }
        if (kendiKalesineGolAtmaKontrolu.blue === 3) {
          if (deplasmanPlayer) {
            room.kickPlayer(
              deplasmanPlayer.id,
              "Bot, ma√ßƒ± sattƒ±ƒüƒ±nƒ± d√º≈ü√ºn√ºyor.",
              true
            );
            tumOyuncularaMesajGonder(
              hostMesajlari.oyuncuAtildi(deplasmanPlayer.name)
            );
          }
        }
      }
      skor.red++;
      let takimliOyuncu = idyeGoreTakimliOyuncuyuDondur(
        fikstur[fiksturSirasi].evSahibi
      );
      let takimAdi = takimiDondur(takimliOyuncu.takimId).adi;
      let golAtanOyuncu = turnuvaZamaniOyunculari.find(
        x => x.id === takimliOyuncu.playerId
      );
      if (!golAtanOyuncu) {
        golAtanOyuncu = turnuvaZamaniOyunculari.find(
          x => x.id === takimliOyuncu.oncekiPlayerId
        );
      }
      let takimTamAd = takimAdi + " (" + golAtanOyuncu.name + ")";

      tumOyuncularaMesajGonder(hostMesajlari.gol(takimTamAd));
      oyunuBaslatKontrol(
        2,
        takimliOyuncular.find(x => x.id === fikstur[fiksturSirasi].deplasman),
        12000
      );
    } else if (team === 2) {
      if (topaDokunmaKontrolu.blue === 0) {
        kendiKalesineGolAtmaKontrolu.red++;
        if (kendiKalesineGolAtmaKontrolu.red === 2) {
          if (evSahibiPlayer) {
            oyuncuyaMesajGonder(evSahibiPlayer.id, hostMesajlari.atilacaksin());
            buHaricHerkeseMesajGonder(
              evSahibiPlayer.id,
              hostMesajlari.oyuncuAtilacak(evSahibiPlayer.name)
            );
          }
        }
        if (kendiKalesineGolAtmaKontrolu.red === 3) {
          if (evSahibiPlayer) {
            room.kickPlayer(
              evSahibiPlayer.id,
              "Bot, ma√ßƒ± sattƒ±ƒüƒ±nƒ± d√º≈ü√ºn√ºyor.",
              true
            );
            tumOyuncularaMesajGonder(
              hostMesajlari.oyuncuAtildi(evSahibiPlayer.name)
            );
          }
        }
      }
      skor.blue++;
      let takimliOyuncu = idyeGoreTakimliOyuncuyuDondur(
        fikstur[fiksturSirasi].deplasman
      );
      let takimAdi = takimiDondur(takimliOyuncu.takimId).adi;
      let golAtanOyuncu = turnuvaZamaniOyunculari.find(
        x => x.id === takimliOyuncu.playerId
      );
      if (!golAtanOyuncu) {
        golAtanOyuncu = turnuvaZamaniOyunculari.find(
          x => x.id === takimliOyuncu.oncekiPlayerId
        );
      }
      let takimTamAd = takimAdi + " (" + golAtanOyuncu.name + ")";
      tumOyuncularaMesajGonder(hostMesajlari.gol(takimTamAd));
      oyunuBaslatKontrol(
        1,
        takimliOyuncular.find(x => x.id === fikstur[fiksturSirasi].evSahibi),
        12000
      );
    }
  }
};

let onPositionsReset = function() {
  if (gameState === 3) {
    topaDokunmaKontroluSifirla();
  }
};

room.onPlayerJoin = onPlayerJoin;
room.onPlayerLeave = onPlayerLeave;
room.onPlayerChat = onPlayerChat;
room.onPlayerKicked = onPlayerKicked;
room.onPlayerBallKick = onPlayerBallKick;
room.onGameStart = onGameStart;
room.onGameStop = onGameStop;
room.onGameTick = onGameTick;
room.onTeamGoal = onTeamGoal;
room.onPositionsReset = onPositionsReset;
